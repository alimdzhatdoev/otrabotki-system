# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ CORS

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ CORS –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ –±—ç–∫–µ–Ω–¥.

## –ü—Ä–∏—á–∏–Ω–∞

CORS (Cross-Origin Resource Sharing) –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏. –ù—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ origin'—ã –Ω–∞ –±—ç–∫–µ–Ω–¥–µ.

## –†–µ—à–µ–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é FRONTEND_URL –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

–í Render Dashboard ‚Üí –≤–∞—à Web Service ‚Üí Environment Variables:

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
FRONTEND_URL=https://otrabotki-system.onrender.com
```

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** 
- URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **—Ç–æ—á–Ω–æ** —Ç–∞–∫–∏–º –∂–µ, –∫–∞–∫ URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- –î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `https://`
- **–ë–ï–ó** —Å–ª–µ—à–∞ –≤ –∫–æ–Ω—Ü–µ (`/`)

### 2. –ö–æ–¥ —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω

–ö–æ–¥ –≤ `server/index.js` —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ CORS. –û–Ω:
- –ß–∏—Ç–∞–µ—Ç `FRONTEND_URL` –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –†–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ origin
- –õ–æ–≥–∏—Ä—É–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
1. –í Render Dashboard –Ω–∞–π–¥–∏—Ç–µ –≤–∞—à Web Service
2. –ù–∞–∂–º–∏—Ç–µ **"Manual Deploy"** ‚Üí **"Deploy latest commit"**
3. –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏—Ç–µ –ª—é–±—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ (Render –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
1. Render Dashboard ‚Üí –≤–∞—à Web Service ‚Üí **"Logs"**
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
3. –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ CORS (–µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã)

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:**
```
üöÄ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:10000
üìÅ –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤: ...
üåç –†–µ–∂–∏–º: production
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è:
```
‚ö†Ô∏è CORS: Blocked origin: ...
‚úÖ CORS: Allowed origins: ...
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ origin –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `FRONTEND_URL`.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥: `https://otrabotki-system.onrender.com`
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏
4. –í –∫–æ–Ω—Å–æ–ª–∏ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ CORS

**–û—à–∏–±–∫–∞ CORS –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:**
```
Access to fetch at 'https://otrabotki-system-back.onrender.com/api/auth/login' 
from origin 'https://otrabotki-system.onrender.com' has been blocked by CORS policy
```

## –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ URL

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `FRONTEND_URL` –Ω–∞ –±—ç–∫–µ–Ω–¥–µ **—Ç–æ—á–Ω–æ** —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:
- ‚úÖ `https://otrabotki-system.onrender.com`
- ‚ùå `https://otrabotki-system.onrender.com/` (–ª–∏—à–Ω–∏–π —Å–ª–µ—à)
- ‚ùå `http://otrabotki-system.onrender.com` (http –≤–º–µ—Å—Ç–æ https)

### –í–∞—Ä–∏–∞–Ω—Ç 2: –í—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –≤—Å–µ origin'—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏!)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –∏–º–µ–Ω–Ω–æ –≤ CORS, –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –≤—Å–µ:

–í `server/index.js` –∑–∞–º–µ–Ω–∏—Ç–µ:
```javascript
origin: function (origin, callback) {
  callback(null, true); // –†–∞–∑—Ä–µ—à–∞–µ–º –≤—Å–µ
}
```

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï:** –≠—Ç–æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è production! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞

–í –ª–æ–≥–∞—Ö Render –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è:
```
‚ö†Ô∏è CORS: Blocked origin: https://otrabotki-system.onrender.com
‚úÖ CORS: Allowed origins: [ 'https://otrabotki-system.onrender.com' ]
üîß CORS: FRONTEND_URL from env: https://otrabotki-system.onrender.com
```

–ï—Å–ª–∏ `FRONTEND_URL from env` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `undefined` –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Frontend (Static Site):
```
VITE_API_URL=https://otrabotki-system-back.onrender.com/api
```

### Backend (Web Service):
```
FRONTEND_URL=https://otrabotki-system.onrender.com
JWT_SECRET=–≤–∞—à-—Å–µ–∫—Ä–µ—Ç–Ω—ã–π-–∫–ª—é—á
NODE_ENV=production
PORT=10000
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

CORS –æ—à–∏–±–∫–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç, –∫–æ–≥–¥–∞:
1. –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏
2. –ë—ç–∫–µ–Ω–¥ –Ω–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ origin
3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∑–∞–≥–æ–ª–æ–≤–∫–∏ (credentials, methods, headers)

–ù–∞—à –∫–æ–¥ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `FRONTEND_URL` —É–∫–∞–∑–∞–Ω –≤–µ—Ä–Ω–æ.



